!function(){"use strict";var t,e,n={d:function(t,e){for(var o in e)n.o(e,o)&&!n.o(t,o)&&Object.defineProperty(t,o,{enumerable:!0,get:e[o]})},o:function(t,e){return Object.prototype.hasOwnProperty.call(t,e)}};n.d({},{j:function(){return P}}),function(t){t.WHITE="white-theme",t.DARK="dark-theme",t.WARM="warm-theme"}(t||(t={})),function(t){t.NOTO="Noto Naskh Arabic",t.TAHOMA="Tahoma",t.ARIAL="Arial"}(e||(e={}));var o,i=function(t,e,n,o){return new(n||(n=Promise))((function(i,a){function r(t){try{c(o.next(t))}catch(t){a(t)}}function s(t){try{c(o.throw(t))}catch(t){a(t)}}function c(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(r,s)}c((o=o.apply(t,e||[])).next())}))},a=function(t,e){var n,o,i,a,r={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(r=0)),r;)try{if(n=1,o&&(i=2&s[0]?o.return:s[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,s[1])).done)return i;switch(o=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return r.label++,{value:s[1],done:!1};case 5:r.label++,o=s[1],s=[0];continue;case 7:s=r.ops.pop(),r.trys.pop();continue;default:if(!((i=(i=r.trys).length>0&&i[i.length-1])||6!==s[0]&&2!==s[0])){r=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){r.label=s[1];break}if(6===s[0]&&r.label<i[1]){r.label=i[1],i=s;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(s);break}i[2]&&r.ops.pop(),r.trys.pop();continue}s=e.call(t,r)}catch(t){s=[6,t],o=0}finally{n=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},r=function(t,e,n){if(n||2===arguments.length)for(var o,i=0,a=e.length;i<a;i++)!o&&i in e||(o||(o=Array.prototype.slice.call(e,0,i)),o[i]=e[i]);return t.concat(o||Array.prototype.slice.call(e))},s="".concat(location.protocol,"//").concat(location.host),c=function(){function t(t){this.id=t,this.chaptersNames=[],this.bookNav=[]}return t.prototype._getNavigation=function(){return i(this,void 0,Promise,(function(){var t;return a(this,(function(e){switch(e.label){case 0:return e.trys.push([0,3,,4]),[4,fetch("".concat(s,"/packages/").concat(this.id,"/Navigation/nav.xhtml"))];case 1:return[4,e.sent().text()];case 2:return[2,e.sent()];case 3:return t=e.sent(),console.log(t),[2,null];case 4:return[2]}}))}))},t.prototype._getHTMLDocument=function(t){return i(this,void 0,Promise,(function(){var e;return a(this,(function(n){switch(n.label){case 0:return n.trys.push([0,3,,4]),[4,fetch("".concat(s,"/packages/").concat(this.id,"/Content/").concat(t))];case 1:return[4,n.sent().text()];case 2:return[2,n.sent()];case 3:return e=n.sent(),console.log(e),[2,null];case 4:return[2]}}))}))},t.prototype.createBookNavigationlist=function(){var t;return i(this,void 0,Promise,(function(){var e,n,o,i,r;return a(this,(function(a){switch(a.label){case 0:return[4,this._getNavigation()];case 1:return e=a.sent(),n=new DOMParser,o=n.parseFromString(e,"text/html"),i=[],(r=null===(t=o.querySelector("ol"))||void 0===t?void 0:t.querySelectorAll("a"))?(r.forEach((function(t){var e,n=null===(e=t.getAttribute("href"))||void 0===e?void 0:e.split("/");n&&i.push(n[n.length-1])})),[2,i]):[2,[]]}}))}))},t.prototype.getHTMLChapters=function(){return i(this,void 0,Promise,(function(){var t,e,n=this;return a(this,(function(o){switch(o.label){case 0:return[4,this.createBookNavigationlist()];case 1:return t=o.sent(),this.bookNav=t,e=[],this.bookNav.forEach((function(t){return i(n,void 0,void 0,(function(){return a(this,(function(n){return e.push(this._getHTMLDocument(t)),[2]}))}))})),[4,Promise.all(r([],e,!0))];case 2:return[2,o.sent().map((function(t){if(!t)return null;var e=(new DOMParser).parseFromString(t,"text/html").querySelector("body");return e&&e.firstElementChild?e.firstElementChild:null}))]}}))}))},t}(),l=function(t,e){localStorage.setItem(t,JSON.stringify(e))},u=function(t){try{var e=localStorage.getItem(t);return e?JSON.parse(e):null}catch(t){return console.log(t),null}};!function(t){t.PAGE_INDEX="page-index",t.FONT_SIZE_RATIO="font-size-ratio",t.PANEL_STATE="panel-state",t.COLOR_THEME="color-theme",t.FONT_FAMILY="font-family"}(o||(o={}));var h=function(){function t(){}return t.book=document.getElementById("book"),t.nextPageButton=document.getElementById("next-page-btn"),t.previousPageButton=document.getElementById("previous-page-btn"),t.nextBulkPageButton=document.getElementById("next-bulk-page-btn"),t.previousBulkPageButton=document.getElementById("previous-bulk-page-btn"),t.smallerFontButton=document.getElementById("smaller-font"),t.resetFontButton=document.getElementById("reset-font"),t.largerFontButton=document.getElementById("larger-font"),t.colorThemeButtons=document.querySelectorAll(".color-btn"),t.fontButtons=document.querySelectorAll(".font-btn"),t.openFontsListButton=document.querySelector(".open-fonts-list"),t.closeFontsListButton=document.querySelector(".close-fonts-list"),t.fontsList=document.querySelector(".fonts-list"),t.fontFeedback=document.querySelector(".open-fonts-list span"),t.controlsButton=document.getElementById("toggle-controls-btn"),t.controlsPopup=document.getElementById("controls-popup"),t.navigationFeedbackText=document.getElementById("navigation-feedback"),t.navigationProgressBar=document.getElementById("navigation-progress-bar"),t.panel=document.querySelector(".panel"),t.paragraphTools=document.getElementById("paragraph-tools"),t.highlightButton=document.getElementById("highlight-btn"),t.unhighlightButton=document.getElementById("unhighlight-btn"),t.copyButton=document.getElementById("copy-btn"),t}(),d=function(){function t(t){this.mediaQueryList=window.matchMedia(t)}return t.prototype.addListener=function(t){this.mediaQueryList.addListener((function(e){t(e.matches)}))},t.prototype.removeListener=function(t){this.mediaQueryList.removeListener((function(e){t(e.matches)}))},Object.defineProperty(t.prototype,"matches",{get:function(){return this.mediaQueryList.matches},enumerable:!1,configurable:!0}),t}(),g=function(){function t(){}return t._updateFontFeedback=function(t){this.selectedFont=t,h.fontFeedback.innerHTML=t},t._updateButtonsDisablity=function(){var t=h.largerFontButton,e=h.smallerFontButton;t.disabled=this.fontSizeRatio>=1.28,e.disabled=this.fontSizeRatio<=.7},t.updateImagesUrl=function(t){t.forEach((function(t){t.setAttribute("src",t.getAttribute("src").replaceAll("/Images/","/packages/".concat(P.bookId,"/Images/")))}))},t.appendChaptersToBody=function(t){h.book.innerHTML="",t.forEach((function(t){h.book.appendChild(t)}))},t.handelResponsivness=function(){var t=new d("(max-width: ".concat(P.mobileBreakporint,"px)"));function e(t){h.book.style.columnCount=t?"1":"2"}t.addListener(e),e(t.matches)},t.setActivePanelState=function(t){var e=h.panel;t?e.classList.add("opened"):e.classList.remove("opened"),this.isActivePanel=t},t.handelTogglePanel=function(){var t=h.panel,e=h.controlsPopup;this.isActivePanel?t.classList.remove("opened"):t.classList.add("opened"),this.isActivePanel&&e.classList.remove("opened"),this.isActivePanel&&this.closeFontsList(),this.isActivePanel=!this.isActivePanel},t.toggleContol=function(){var t=h.controlsPopup;this.isActiveControls?t.classList.remove("opened"):t.classList.add("opened"),this.isActiveControls=!this.isActiveControls},t.smallerFont=function(){if(!(this.fontSizeRatio<=.7)){var t=h.book,e=h.resetFontButton;this.fontSizeRatio-=.15,t.style.fontSize="".concat(this.fontSizeRatio,"rem"),e.innerHTML="".concat(Math.ceil(100*this.fontSizeRatio),"%"),this._updateButtonsDisablity(),f.updateNavigation(),l(o.FONT_SIZE_RATIO,this.fontSizeRatio)}},t.resetFont=function(){var t=h.book,e=h.resetFontButton;this.fontSizeRatio=1,t.style.fontSize="1rem",e.innerHTML="100%",this._updateButtonsDisablity(),f.updateNavigation(),l(o.FONT_SIZE_RATIO,this.fontSizeRatio)},t.largerFont=function(){if(!(this.fontSizeRatio>=1.28)){var t=h.book,e=h.resetFontButton;this.fontSizeRatio+=.15,t.style.fontSize="".concat(this.fontSizeRatio,"rem"),e.innerHTML="".concat(Math.ceil(100*this.fontSizeRatio),"%"),this._updateButtonsDisablity(),f.updateNavigation(),l(o.FONT_SIZE_RATIO,this.fontSizeRatio)}},t.setColorTheme=function(t){document.body.setAttribute("class",""),document.body.classList.add(t),h.colorThemeButtons.forEach((function(e){var n=e.getAttribute("data-value");t===n?e.classList.add("selected"):e.classList.remove("selected")})),l(o.COLOR_THEME,t)},t.setFont=function(t){var e=this,n=h.book,i=h.fontButtons;n.setAttribute("class",""),n.classList.add(t.replaceAll(" ","-")),i.forEach((function(n){var o=n.getAttribute("data-value");t===o?n.classList.add("selected"):n.classList.remove("selected"),t===o&&e._updateFontFeedback(t)})),f.updateNavigation(),l(o.FONT_FAMILY,t)},t.setFontSizeRatio=function(t){if(!(t<.65||t>1.35)){var e=h.book,n=h.resetFontButton;this.fontSizeRatio=t,e.style.fontSize="".concat(this.fontSizeRatio,"rem"),n.innerHTML="".concat(Math.ceil(100*this.fontSizeRatio),"%"),this._updateButtonsDisablity(),f.updateNavigation(),l(o.FONT_SIZE_RATIO,t)}},t.openFontsList=function(){var t=h.fontsList;this.fontsListOriginalParentHeight=t.parentElement.offsetHeight,t.parentElement.style.height="".concat(this.fontsListOriginalParentHeight,"px"),t.parentElement.style.height="".concat(t.offsetHeight,"px"),t.classList.add("slide-up")},t.closeFontsList=function(){var t=h.fontsList;t.parentElement.style.height="".concat(this.fontsListOriginalParentHeight,"px"),t.classList.remove("slide-up")},t.showParagraphtools=function(){h.paragraphTools.classList.add("opened"),this.isActiveParagraphTools=!0},t.hideParagraphtools=function(){h.paragraphTools.classList.remove("opened"),this.isActiveParagraphTools=!1},t.handelParagraphtools=function(t){var e=t.getBoundingClientRect(),n=e.top,o=e.left,i=h.paragraphTools,a=h.highlightButton,r=h.unhighlightButton;i.style.top=t.clientTop+"".concat(n-65,"px"),i.style.left=t.clientLeft+"".concat(o-30+t.offsetWidth/2,"px"),this.selectedParagraph=t,t.classList.contains("highlighted")?(a.style.display="none",r.style.display="block"):(a.style.display="block",r.style.display="none")},t.highlightParagraph=function(){this.selectedParagraph.classList.add("highlighted"),this.hideParagraphtools()},t.unhighlightParagraph=function(){this.selectedParagraph.classList.remove("highlighted"),this.hideParagraphtools()},t.handelCopy=function(){this.selectedParagraph&&(navigator.clipboard.writeText(this.selectedParagraph.innerText),this.hideParagraphtools())},t.isActiveControls=!1,t.isActiveFontsList=!1,t.isActiveParagraphTools=!1,t.fontSizeRatio=1,t}(),f=function(){function t(){}return t.isNextEnabled=function(t){return void 0===t&&(t=1),this.currentPageIndex+1<this.getPagesCount()-t+1},t.isPreviousEnabled=function(t){return void 0===t&&(t=1),this.currentPageIndex+1>t},t.getCurrentPage=function(){var t=this.currentPageIndex+1;return t>this.getPagesCount()?(this.currentPageIndex=this.getPagesCount()-1,this.getPagesCount()):t<1?(this.currentPageIndex=0,1):t},t.getPagesCount=function(){var t=Math.ceil(h.book.scrollWidth/this.getBookWidth());return this.pagesCount=t,t},t.getScrollX=function(t){void 0===t&&(t=null);var e=t?t-1:null;return this.getBookWidth()*(null!=e?e:this.currentPageIndex)},t.getBookWidth=function(){return h.book.getBoundingClientRect().width-20},t.updateNavigation=function(){var t=this;g.hideParagraphtools();var e=h.nextPageButton,n=h.previousPageButton,i=h.nextBulkPageButton,a=h.previousBulkPageButton;e.disabled=!this.isNextEnabled(),i.disabled=!this.isNextEnabled(P.allowedNavigationSteps),n.disabled=!this.isPreviousEnabled(),a.disabled=!this.isPreviousEnabled(P.allowedNavigationSteps),l(o.PAGE_INDEX,this.currentPageIndex),setTimeout((function(){h.navigationProgressBar.style.width="".concat(t.getCurrentPage()/t.pagesCount*100,"%"),h.navigationFeedbackText.innerHTML="".concat(t.getCurrentPage()," / ").concat(t.getPagesCount())}),0)},t.next=function(t){void 0===t&&(t=1),this.getCurrentPage()>=this.getPagesCount()||(this.currentPageIndex+=t,h.book.scrollTo({top:0,left:-this.getScrollX(),behavior:"auto"}),this.updateNavigation())},t.previous=function(t){void 0===t&&(t=1),this.getCurrentPage()<=1||(this.currentPageIndex-=t,h.book.scrollTo({top:0,left:-this.getScrollX(),behavior:"auto"}),this.updateNavigation())},t.goToPage=function(t){t<1||t>this.getPagesCount()||(h.book.scrollTo({top:0,left:-this.getScrollX(t),behavior:"auto"}),this.updateNavigation())},t}(),p=function(){function t(){}return t.preventScroll=function(t){return t.preventDefault(),t.stopPropagation(),!1},t.initEventListerns=function(){var t=h.nextPageButton,e=h.previousPageButton,n=h.nextBulkPageButton,o=h.previousBulkPageButton,i=h.book,a=h.smallerFontButton,r=h.resetFontButton,s=h.largerFontButton,c=h.controlsButton,l=h.openFontsListButton,u=h.closeFontsListButton,d=h.colorThemeButtons,p=h.fontButtons,v=h.highlightButton,m=h.unhighlightButton,b=h.copyButton;window.addEventListener("wheel",this.preventScroll,{passive:!1}),window.addEventListener("resize",(function(){g.hideParagraphtools()})),window.addEventListener("resize",function(t,e){var n,o=this;return function(){for(var i=[],a=0;a<arguments.length;a++)i[a]=arguments[a];clearTimeout(n),n=setTimeout((function(){t.apply(o,i)}),e)}}((function(){f.updateNavigation(),f.goToPage(f.currentPageIndex+1)}),500)),i.addEventListener("click",(function(t){var e=document.getSelection();g.hideParagraphtools(),"P"!==t.target.tagName?"Range"!==e.type&&g.handelTogglePanel():g.showParagraphtools()})),t.addEventListener("click",(function(){f.next()})),e.addEventListener("click",(function(){f.previous()})),n.addEventListener("click",(function(){f.next(P.allowedNavigationSteps)})),o.addEventListener("click",(function(){f.previous(P.allowedNavigationSteps)})),c.addEventListener("click",(function(){g.toggleContol()})),a.addEventListener("click",(function(){g.smallerFont()})),r.addEventListener("click",(function(){g.resetFont()})),s.addEventListener("click",(function(){g.largerFont()})),l.addEventListener("click",(function(){g.openFontsList()})),u.addEventListener("click",(function(){g.closeFontsList()})),v.addEventListener("click",(function(){g.highlightParagraph()})),m.addEventListener("click",(function(){g.unhighlightParagraph()})),b.addEventListener("click",(function(){g.handelCopy()})),d.forEach((function(t){t.addEventListener("click",(function(){var t=this.getAttribute("data-value");g.setColorTheme(t)}))})),p.forEach((function(t){t.addEventListener("click",(function(){var t=this.getAttribute("data-value");g.setFont(t)}))}))},t.initParagraphsEventListener=function(t){t.forEach((function(t){t.addEventListener("click",(function(){g.handelParagraphtools(this)}))}))},t}(),v=p,m=function(){function t(t){this.bookParagraphs=t}return t.prototype.initTool=function(){v.initParagraphsEventListener(this.bookParagraphs)},t}(),b=function(){function t(t){this.bookSettings=t}return t.prototype.initBook=function(){return t=this,e=void 0,o=function(){var t,e,n;return function(t,e){var n,o,i,a,r={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(r=0)),r;)try{if(n=1,o&&(i=2&s[0]?o.return:s[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,s[1])).done)return i;switch(o=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return r.label++,{value:s[1],done:!1};case 5:r.label++,o=s[1],s=[0];continue;case 7:s=r.ops.pop(),r.trys.pop();continue;default:if(!((i=(i=r.trys).length>0&&i[i.length-1])||6!==s[0]&&2!==s[0])){r=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){r.label=s[1];break}if(6===s[0]&&r.label<i[1]){r.label=i[1],i=s;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(s);break}i[2]&&r.ops.pop(),r.trys.pop();continue}s=e.call(t,r)}catch(t){s=[6,t],o=0}finally{n=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}}(this,(function(o){switch(o.label){case 0:return g.setColorTheme(this.bookSettings.defaultColorTheme),g.setFont(this.bookSettings.defaultFont),this.data=new c(this.bookSettings.bookId),[4,this.data.getHTMLChapters()];case 1:return t=o.sent(),g.appendChaptersToBody(t),e=document.querySelectorAll("#book img"),g.updateImagesUrl(e),g.setActivePanelState(this.bookSettings.isPanelOpened),g.setColorTheme(this.bookSettings.defaultColorTheme),g.setFont(this.bookSettings.defaultFont),g.setFontSizeRatio(this.bookSettings.defaultFontSizeRatio),f.currentPageIndex=this.bookSettings.defaultPageIndex,f.goToPage(this.bookSettings.defaultPageIndex+1),f.updateNavigation(),v.initEventListerns(),g.handelResponsivness(),n=document.querySelectorAll("#book p"),new m(n).initTool(),[2]}}))},new((n=Promise)||(n=Promise))((function(i,a){function r(t){try{c(o.next(t))}catch(t){a(t)}}function s(t){try{c(o.throw(t))}catch(t){a(t)}}function c(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(r,s)}c((o=o.apply(t,e||[])).next())}));var t,e,n,o},t}(),y=b,P={bookId:"26dd5f00-0c75-4367-adea-537ece731385",pagesPerScreen:2,defaultPageIndex:u(o.PAGE_INDEX)||0,allowedNavigationSteps:10,mobileBreakporint:1024,isPanelOpened:u(o.PANEL_STATE)||!1,defaultFontSizeRatio:u(o.FONT_SIZE_RATIO)||1,defaultColorTheme:u(o.COLOR_THEME)||t.WHITE,defaultFont:u(o.FONT_FAMILY)||e.NOTO};new y(P).initBook()}();
//# sourceMappingURL=main.fc2a09b3feaf0719fdc3.js.map